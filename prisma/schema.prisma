datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}

generator client {
  provider = "prisma-client-js"
}

model User {
  id              Int       @id @default(autoincrement())
  fullname        String?
  username        String    @unique
  mobile          String
  email           String?
  password        String
  txnPassword     String

  referralCode    String    // who referred him (upline username)
  referredBy      Int?      // upline userId  
  parent          User?     @relation("UserParent", fields: [referredBy], references: [id])
  children        User[]    @relation("UserParent")

  isActive        Boolean   @default(false)
  isBlocked       Boolean   @default(false)
  isSuspended     Boolean   @default(false)

  createdAt       DateTime  @default(now())

  deposits        Deposit[]
  withdraws       Withdraw[]
  wallet          Wallet?
}

model Wallet {
  id              Int     @id @default(autoincrement())
  userId          Int     @unique
  user            User    @relation(fields: [userId], references: [id])

  mainWallet      Float   @default(0)
  roiWallet       Float   @default(0)
  referralWallet  Float   @default(0)
  levelWallet     Float   @default(0)
  returnWallet    Float   @default(0)
  salaryWallet    Float   @default(0)
  donationWallet  Float   @default(0)
}

model Deposit {
  id              Int       @id @default(autoincrement())
  userId          Int
  user            User      @relation(fields: [userId], references: [id])
  amount          Float
  trxId           String
  status          String    @default("pending") // pending | approved | rejected | return
  createdAt       DateTime  @default(now())
}

model Withdraw {
  id              Int       @id @default(autoincrement())
  userId          Int
  user            User      @relation(fields: [userId], references: [id])

  amount          Float
  walletType      String
  status          String    @default("pending")
  createdAt       DateTime  @default(now())
}

model Admin {
  id        Int       @id @default(autoincrement())
  username  String    @unique
  password  String
  createdAt DateTime  @default(now())
}
